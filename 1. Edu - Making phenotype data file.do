
********************************************************************************
*******************         MAKING DATASET WOMEN       *************************
********************************************************************************
use "**.dta", clear

keep n_eid n_2734_0_0 n_21003_0_0 n_31_0_0 n_34_0_0 n_52_0_0 n_54_0_0 n_738_0_0 n_845_0_0 n_1239_0_0  ///
n_1249_0_0 n_1259_0_0 n_1558_0_0 n_2040_0_0 n_2129_0_0  n_2139_0_0 n_2149_0_0 n_2178_0_0 ///
n_2385_0_0 n_2405_0_0 n_2644_0_0 n_2714_0_0 n_2724_0_0 n_2734_0_0 n_2754_0_0 n_2764_0_0  ///
n_2774_0_0 n_2784_0_0 n_2794_0_0 n_2804_0_0 n_2814_0_0 n_2824_0_0 n_2867_0_0 n_2887_0_0 ///
n_2897_0_0 n_2907_0_0 n_3140_0_0 n_3436_0_0 n_3456_0_0 n_3466_0_0 n_3581_0_0 n_3591_0_0  ///
n_3659_0_0 n_3731_0_0 n_3829_0_0 n_3839_0_0  n_3872_0_0 n_4462_0_0 n_6138_0_0 n_6138_0_1 n_6138_0_2 n_6138_0_3 n_6138_0_4 n_6138_0_5 ///
n_6142_0_0 n_6142_0_1 n_6142_0_2 n_6142_0_3 n_6142_0_4 n_6142_0_5 n_6142_0_6 ///
n_6183_0_0 n_6194_0_0 n_20116_0_0 n_20117_0_0 n_20119_0_0 n_21000_0_0 n_21001_0_0 n_21002_0_0 ///
n_21003_0_0 n_23104_0_0 n_23106_0_0 n_50_0_0 n_20016_0_0 n_5057_0_0 n_1807_0_0 n_3526_0_0 n_1767_0_0 n_189_0_0

count // 273,467
save "**.dta", replace

* Merge in withdrawals
merge 1:1 n_eid using "**.dta"
drop if _merge ==2
drop if _merge ==3
drop _merge

* Saving women dataset
gen sex = n_31_0_0 // check just women (coded as 0)

save "**.dta", replace

********************************************************************************
*********************         MAKING DATASET MEN       *************************
********************************************************************************
use "**.dta", clear

keep n_eid n_2734_0_0 n_31_0_0 n_21003_0_0 n_34_0_0 n_52_0_0 n_54_0_0 n_738_0_0 n_845_0_0 n_1239_0_0  ///
n_1249_0_0 n_1259_0_0 n_1558_0_0 n_2040_0_0 n_2129_0_0  n_2139_0_0 n_2149_0_0 n_2178_0_0 ///
n_2385_0_0 n_2405_0_0 n_2644_0_0 n_2714_0_0 n_2724_0_0 n_2734_0_0 n_2754_0_0 n_2764_0_0  ///
n_2774_0_0 n_2784_0_0 n_2794_0_0 n_2804_0_0 n_2814_0_0 n_2824_0_0 n_2867_0_0 n_2887_0_0 ///
n_2897_0_0 n_2907_0_0 n_3140_0_0 n_3436_0_0 n_3456_0_0 n_3466_0_0 n_3581_0_0 n_3591_0_0  ///
n_3659_0_0 n_3731_0_0 n_3829_0_0 n_3839_0_0  n_3872_0_0 n_4462_0_0 /// 
n_6138_0_0 n_6138_0_1 n_6138_0_2 n_6138_0_3 n_6138_0_4 n_6138_0_5 ///
n_6142_0_0 n_6142_0_1 n_6142_0_2 n_6142_0_3 n_6142_0_4 n_6142_0_5 n_6142_0_6 ///
n_6183_0_0 n_6194_0_0 n_20116_0_0 n_20117_0_0 n_20119_0_0 n_21000_0_0 n_21001_0_0 n_21002_0_0 ///
n_21003_0_0 n_23104_0_0 n_23106_0_0 n_50_0_0 n_20016_0_0 n_5057_0_0 n_1807_0_0 n_3526_0_0 n_1767_0_0 n_189_0_0

count //229, 182

* Merge in withdrawals
merge 1:1 n_eid using "**.dta"
drop if _merge ==2
drop if _merge ==3
drop _merge
count

* Saving men dataset
gen sex = n_31_0_0 // check just men (coded as 1)
tab sex

save "**.dta", replace

********************************************************************************
********************           MERGING DATASETS         ************************
********************************************************************************

use "**.dta", clear

merge 1:1 n_eid using "**.dta"
drop if _merge==3
drop _merge
save "**.dta", replace

********************************************************************************
************************           SPLIT VAR         ***************************
********************************************************************************

* merge in interim genetic release data to generate a split var incase need to split in any analysis checks
merge m:1 n_eid using "**.dta", keepus(n_22003_0_0 n_22001_0_0)
drop if _merge==1 
drop if _merge==2
drop _merge
gen split = .
replace split = 1 if n_22001_0_0!=.
replace split = 2 if split!=1

save "**.dta", replace






